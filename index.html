<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>CODEHENGE</title>
        <link href="https://fonts.googleapis.com/css?family=Covered+By+Your+Grace" rel="stylesheet" type="text/css">
        <style>
            body, input { margin: 0; 
                    font-family: 'Covered By Your Grace', serif;
            }
            canvas { width: 100%; height: 100% }
                #info {
                font-family: 'Covered By Your Grace', serif;        
                position: absolute;
                padding: 10px;
                width: 100%;
                text-align: center;
            }
        </style>
    </head>
    <body>
        <div id="info">CODEHENGE<br />
		enter the word hidden in the stones<br />
            <form onSubmit="return false;">
                <input type="text" id="a" value="" maxlength="8" style="width:8em"><br>
                <input type="button" value="Submit" onclick="foo('a');" />
            </form>
        </div>
        <script src="three.min.js"></script>
        <script src="OrbitControls.js"></script>
        <script src="OBJLoader.js"></script>
        <script>
            var scene = new THREE.Scene();
            scene.fog = new THREE.Fog(0xcce0ff, 400, 5000);
            var camera = new THREE.PerspectiveCamera(30, window.innerWidth / window.innerHeight, 1, 10000);
            camera.position.x = 1000;
            camera.position.y = 0;
            camera.position.z = 1500;
            scene.add(camera);
            var renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(scene.fog.color);
            renderer.shadowMapEnabled = true;
            renderer.shadowMapType = THREE.PCFSoftShadowMap;
            document.body.appendChild(renderer.domElement);
            window.addEventListener('resize', onWindowResize, false);
            var controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.maxPolarAngle = Math.PI * 0.5;
            controls.minDistance = 1000;
            controls.maxDistance = 7500;
            //scene.add(new THREE.AmbientLight(0x666666));
            var light = new THREE.HemisphereLight( 0xffffbb, 0x080820, 1 );
            scene.add( light );
    		light = new THREE.DirectionalLight( 0xdfebff, 1 );
		light.position.set( 50, 200, 100 );
		light.position.multiplyScalar( 1.3 );
	
		light.castShadow = true;
	
		light.shadow.mapSize.width = 1024;
		light.shadow.mapSize.height = 1024;
	
		var d = 1000;
	
		light.shadow.camera.left = - d;
		light.shadow.camera.right = d;
		light.shadow.camera.top = d;
		light.shadow.camera.bottom = - d;
	
		light.shadow.camera.far = 1000;
	
		scene.add( light );

            
            function create (filename){
	            var btex = new THREE.Texture();
	            var loader = new THREE.ImageLoader(manager);
	            loader.load('henge.jpg', function (image) {
	                btex.image = image;
	                btex.needsUpdate = true;
	            });
	            var manager = new THREE.LoadingManager();
	            var loader = new THREE.OBJLoader(manager);
	            loader.load(filename, function (object) {
	                object.traverse(function (child) {
	                    if (child instanceof THREE.Mesh) {
	                        child.material.map = btex;
	                        child.material.side = THREE.DoubleSide;
	                        child.castShadow = true;
	                        child.receiveShadow = true;
	                    }
	                });
	                object.position.y = 1;
	                object.rotation.x = -Math.PI / 2;
	                object.rotation.z = 2.36; 
	                object.scale.x = object.scale.y = object.scale.z = 100;
	                scene.add(object);
	            }, undefined, undefined);
            }
            
            create('stonehenge.obj');
            
            function onWindowResize() {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            }
            
            var render = function () {
                requestAnimationFrame(render);
                renderer.render(scene, camera);
            };
            
            render();

            function foo(a) {
                elemA = document.getElementById(a).value;
                var code = hashcode(elemA);
                console.log(code);
                if(code === 34984043 || code === 2044408907 || code === -1919328405){
                	create('reveal.obj');
                	document.getElementById("info").innerHTML = "whatever";
                }
            }
            function hashcode(str){
                var hash = 5381;
                for (i = 0; i < str.length; i++) {
                    char = str.charCodeAt(i);
                    hash = ((hash << 5) + hash) + char;
                }
                return hash;
            }
        </script>
    </body>
</html>
